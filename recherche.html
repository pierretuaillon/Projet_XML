<script type="text/javascript" src="__header.js"></script>

<!-- Inclusion du module socket.io -->
<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">

// Connexion au socket serveur
var socket = io.connect();

//Variable global

//Resultat par référence;
var requeteToutesRegions;
var requeteCommune;

// Gestion de la réception du résultat de la requête
function notification(content, requete){

	if(requete=='regions'){
	 alert('Le serveur a envoye les regions : '+content);
		requeteToutesRegions=content;
	}else if (requete == 'commune'){
		requeteCommune = content;
	}
}

//fonction appelé au changement dans les listes
function envoieChoix(id){
	var choixSelect = document.getElementById(id);
}
 window.onload = function() {
        document.myform.action = requete();
		//addOptions('idChxType', 'Region', requeteToutesRegions);
    }
	
function requete() {
	socket.emit('ref', 'Nothing');//('ref'),document.getElementById("ref"));
	   	 socket.on(('resultatRequete',message), function(message) {
			document.getElementById("resultat").innerHTML=message;// createHTML(message);
	  	});
}

			
// recuperation des messages "Region" du socket serveur
socket.on('resultatRequeteToutesLesRegions', function(x) { notification(x,'regions'); });


function addOptions(id, genese, req){
/* API Option
optionElementReference
A reference to the newly created HTMLOptionElement.
text
A string that sets the content of the element, i.e. the displayed text.
value
A string that sets the value attribute.
defaultSelected
A boolean that sets the selected attribute, the default is false. A value of true does not set the option to selected. 
selected
A boolean that sets the option's selected state, the default is false (not selected). If omitted, even if the defaultSelected argument is true, the option is not selected.
*/

	new Option("Text","Value", "defaultSelected true / false", "selected true / false");

	var List = document.getElementById(id);

	var elOption= new Array(req.length);




	for(i=0;i<req.length;i++){

		elOption[i]=new Option(req[i], ("r"+i), false, false);
	}

 	
	var i, n;
	n = elOption.length;
 
	for (i=0; i<n; i++){
		List.options.add(elOption[i]);
	}

    document.getElementById(genese).disabled="false";
}

function initialize(){

}


initialize();

</script>

<div class="container contenu">
	<div class="jumbotron">
		<center>
    	<h1>Recherche</h1><p>Interrogation de la base de données des Immeubles protégés au titre des Monuments Historiques :</p>
		</center>
    </div>

    <div class="row">
    	<div class="col-md-6">
    		<!-- Formulaire de navigation dans les donnees "Region"-->
    		<h3>Régions - <input id="Region" class="btnGenese" type="button" value="Générer" onclick="addOptions('idChxType', 'Region', requeteToutesRegions)" /></h3>
    		<form  name="frmSearchType">
			<span>Parmi les différentes Régions :</span> <select id="idChxType" name="ChoixType" onchange="envoieChoix('idChxType');">
				<option value="" selected="selected">-- Faites votre choix --</option>
			</select></form></br>
    	</div>
    </div>
</div>
<p id="resultat"></p>
<script type="text/javascript" src="__footer.js"></script>